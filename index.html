<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <!--<link rel="stylesheet" type="text/css" href="style.css">-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Office Giphy Section</title>
    <link rel="stylesheet" type="text/css" href="assets\css\OfficeMeme.css">
    <script src="https://www.gstatic.com/firebasejs/4.12.0/firebase.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.4/css/bulma.min.css">
    <link href="https://fonts.googleapis.com/css?family=Special+Elite" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  
</head>
<body>
<div class="container"> 
    <img src="assets/images/Sign.png"class="center">
  </div>
  <!--Model Button-->
  <div class="row">
    <div class="col-lg-6 col-md-12 modalRow text-center">
<br>
<a class="button is-danger is-large" id="modalButton">Add Your Favorite Office Quote!!</a>
 <!--modal card and info-->
    <div class="modal" id="officeModal">
      <div class="modal-background"></div>
          <div class="modal-card">
              <header class="modal-card-head">
                  <p class="modal-card-title"id="Pmodal">What is your favorite office character quote?</p>
                  <button class="delete" aria-label="close"></button>
              </header>
    <section class="modal-card-body">
      <form role="form">
          <div class="form-group row">
            <label for="age-input">Age:</label>
              <input class="form-control" id="age-input" type="number" placeholder="e.g 25">
          </div>
          <div class="form-group row">
            <label for="quote-input">Favorite Quote</label>
              <textarea class="form-control" id="quote-input" rows="5" placeholder="'That's What She Said' - Micheal Scott"></textarea>
          </div>
    <button class="btn btn-default" id="add-user" type="submit">Submit</button>
      </form>
          </div>
    </div>
      </div>
  <!--Office Theme song-->
    <div class="col-lg-6 col-md-12 audioDiv text-center">
      <audio controls src="./assets/The Office.mp3"></audio>
    </div>
  </div>
</div>


<br>
<!--Carousel-->
    <div id="carouselExampleInterval" class="carousel slide" data-ride="carousel">
        <div class="carousel-inner">

          <div class="carousel-item active" data-interval="2000">
            <img class="carousel-images" data-character="Michael Scott" src="assets\images\Michael.jpg" class="d-block w-100" alt="...">
            </div>
          <div class="carousel-item" data-interval="2000">
            <img class="carousel-images" data-character="Jim Halpert" src="assets\images\Jim.jpg" class="d-block w-100" alt="...">
            </div>
          <div class="carousel-item" data-interval="2000">
              <img class="carousel-images" data-character="Dwight Schrute" src="assets\images\Dwight.jpg" class="d-block w-100" alt="...">
            </div>
          <div class="carousel-item" data-interval="2000">
              <img class="carousel-images" data-character="Pam Beesly" src="assets\images\Pam.jpg" class="d-block w-100" alt="...">
            </div>
          <div class="carousel-item" data-interval="2000">
              <img class="carousel-images" data-character="Kevin Malone" src="assets\images\Kevin.jpg" class="d-block w-100" alt="...">
            </div>
          <div class="carousel-item" data-interval="2000">
              <img class="carousel-images" data-character="Angela Martin" src="assets\images\Angela.jpg"  class="d-block w-100" alt="...">
            </div>
          <div class="carousel-item" data-interval="2000">
              <img class="carousel-images" data-character="Toby Flenderson" src="assets\images\Toby.jpg"  class="d-block w-100" alt="...">
            </div>
          <div class="carousel-item" data-interval="2000">
              <img class="carousel-images" data-character="Ryan Howard" src="assets\images\Ryan.jpg"  class="d-block w-100" alt="...">
            </div>
          <div class="carousel-item" data-interval="2000">
              <img class="carousel-images" data-character="Stanley Hudson" src="assets\images\Stanley.jpg"  class="d-block w-100" alt="...">
            </div>   
          <div class="carousel-item" data-interval="2000">
              <img class="carousel-images" data-character="Meredith Palmer" src="assets\images\Meredith.jpg"  class="d-block w-100" alt="...">
            </div>  
          <div class="carousel-item" data-interval="2000">
              <img class="carousel-images" data-character="Creed Bratton" src="assets\images\Creed.jpg"  class="d-block w-100" alt="...">
            </div>
          <div class="carousel-item" data-interval="2000">
              <img class="carousel-images" data-character="Kelly Kapoor" src="assets\images\Kelly.jpg"  class="d-block w-100" alt="...">
            </div>
          <div class="carousel-item" data-interval="2000">
              <img class="carousel-images" data-character="Phyllis Vance" src="assets\images\Phyllis.jpg"  class="d-block w-100" alt="...">
            </div>
            <div class="carousel-item" data-interval="2000">
                <img class="carousel-images" data-character="Oscar Martinez" src="assets\images\Oscar.jpg"  class="d-block w-100" alt="...">
              </div>
            <div class="carousel-item" data-interval="2000">
                <img class="carousel-images" data-character="Darryl Philbin" src="assets\images\Darryl.jpg"  class="d-block w-100" alt="...">
              </div>  
            <div class="carousel-item" data-interval="2000">
                  <img class="carousel-images" data-character="Andy Bernard" src="assets\images\Andy.jpg"  class="d-block w-100" alt="...">
              </div>  
            <div class="carousel-item" data-interval="2000">
                    <img class="carousel-images" data-character="Erin Hannon" src="assets\images\Erin.jpg"  class="d-block w-100" alt="...">
              </div>  
            <div class="carousel-item" data-interval="2000">
                      <img class="carousel-images" data-character="Gabe Lewis" src="assets\images\Gabe.jpg"  class="d-block w-100" alt="...">
              </div>  
        </div>
        <a class="carousel-control-prev" href="#carouselExampleInterval" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
        <a class="carousel-control-next" href="#carouselExampleInterval" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
      </div>

<!--Character Image Grid-->
<div class="container">
        <div class="row">
          <div class="col-md-12 text-center">
          <button data-character="Pam Beesly" id="close-image"><img src="assets\images\Pam.jpg">Pam</button>
          <button data-character="Dwight Schrute"id="close-image"><img src="assets\images\Dwight.jpg">Dwight</button>
          <button data-character="Jim Halpert"id="close-image"><img src="assets\images\Jim.jpg">Jim</button>
          <button data-character="Micheal Scott"id="close-image"><img src="assets\images\Michael.jpg">Micheal</button>
          <button data-character="Kevin Malone" id="close-image"><img src="assets\images\Kevin.jpg">Kevin</button>
          <button data-character="Andy Bernard" id="close-image"><img src="assets\images\Andy.jpg">Andy</button>
        </div>
    </div>
  
<div class="row">
    <div class="col-md-12 text-center">
  <button data-character="Angela Martin" id="close-image"><img src="assets\images\Angela.jpg">Angela</button>
  <button data-character="Toby Flenderson" id="close-image"><img src="assets\images\Toby.jpg">Toby</button>
  <button data-character="Ryan Howard" id="close-image"><img src="assets\images\Ryan.jpg">Ryan</button>
  <button data-character="Stanley Hudson" id="close-image"><img src="assets\images\Stanley.jpg">Stanley</button>
  <button data-character="Meredith Palmer" id="close-image"><img src="assets\images\Meredith.jpg">Meredith</button>
  <button data-character="Erin Hannon" id="close-image"><img src="assets\images\Erin.jpg">Erin</button>
</div>
</div>

  <div class="row">
      <div class="col-md-12 text-center">
  <button data-character="Creed Bratton" id="close-image"><img src="assets\images\Creed.jpg">Creed</button>
  <button data-character="Kelly Kapoor" id="close-image"><img src="assets\images\Kelly.jpg">Kelly</button>
  <button data-character="Phyllis Vance" id="close-image"><img src="assets\images\Phyllis.jpg">Phyllis</button>
  <button data-character="Oscar Martinez" id="close-image"><img src="assets\images\Oscar.jpg">Oscar</button>
  <button data-character="Darryl Philbin" id="close-image"><img src="assets\images\Darryl.jpg">Darryl</button>
  <button data-character="Gabe Lewis" id="close-image"><img src="assets\images\Gabe.jpg">Gabe</button>
  
</div>
</div>


<br>
<br>
<!--Modal Placement div-->
<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div class="card text-center">
                <div class="card-header">
                Your Favorite Office Quote:
                </div>
                <div class="card-body">
                  <div id="full-member-list"></div>
                </div>
            </div>
        </div>
    </div>

<!--Gif placement div-->
<div class="container">
    <div class="row">
      <div class="col-md" id="characterGifs">
    </div>
  </div>
  <!-- <div id="characterGifs"></div> -->
</div>
</div>
</div>

<!--Video placement div-->
<div class="container">
<div class="row" id= "videos"></div>
</div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script type="text/javascript">
        $('.carousel-images').on('click',function(){
          var x = $(this).data("character");
          console.log(x);
          var queryURL = "https://api.giphy.com/v1/gifs/search?q="+x+"&api_key=8Ykbk0xjP3DLoOmjiO3XiGKYxMbn3q82&limit=4";
          $.ajax({
            url: queryURL,
             method: "GET" })
             .done(function(response){
                var charRow = $("<div>")
                    charRow.addClass("row")
                for (var i=0; i<response.data.length;i++){
                  var characterDiv = $('<div>');
                    characterDiv.addClass("col-md-3")
                  var p = $('<p>').text(response.data[i].title);
                  var characterImage = $("<img>");
                  characterImage.attr('src',response.data[i].images.fixed_height_small.url);
                  characterDiv.append(characterImage);
                  characterDiv.append(p);
                  charRow.append(characterDiv)
                  $('#characterGifs').append(charRow);
                  console.log(response);
                }
               
             })
            var videos = $(this).attr("data-name");
        var queryURL = "https://www.googleapis.com/youtube/v3/search?q=" + "the office " + x + "&key=AIzaSyDNYBIL5UBvZd2dGGQzd0ZxfDZzEB8UdS4&part=snippet&type=video";
        var videoFormat="https://www.youtube.com/embed?v="
        $.ajax({
          url: queryURL,
          method: "GET"
        }).done(function(response) {
            var vidRow = $("<div>")
                    vidRow.addClass("row")
            console.log('videos', response.items);
            for (var i=0; i<response.items.length;i++){
                  var characterDiv = $('<div>');
                    characterDiv.addClass("col-md-4")
                  var p = $('<p>').text(response.items[i].snippet.title);
                  var characterVideo = $("<iframe>");
                  characterVideo.attr('src',videoFormat + response.items[i].id.videoId);
                  console.log(characterVideo);
                  characterDiv.append(characterVideo);
                  characterDiv.append(p);
                  vidRow.append(characterDiv)
                  $('#videos').append(vidRow);
          console.log(response);
        }       
        });
    });
   
     // Javascript for modal 
  
    
    var buttonOne = document.getElementById('modalButton');
    var modal = document.getElementById('officeModal');
    var close = document.getElementsByClassName("delete") [0];
  
    buttonOne.onclick = function () {
      modal.style.display = 'block';
    }
    close.onclick = function() {
      modal.style.display = "none";
    }

  // Initialize Firebase
  var config = {
      apiKey: "AIzaSyChsJIztLBG4DSvzmqAzjf6tFG5XLJG0rM",
      authDomain: "the-office-meme-project.firebaseapp.com",
      databaseURL: "https://the-office-meme-project.firebaseio.com",
      projectId: "the-office-meme-project",
      storageBucket: "the-office-meme-project.appspot.com",
      messagingSenderId: "472637649504"
    };
    firebase.initializeApp(config);

    var dataRef = firebase.database();
    
    var age = 0;
    var quote = "";

      $("#add-user").on("click", function (event) {  //capture button click
      event.preventDefault();
      modal.style.display = 'none'

      console.log("add-user", "click");

      age = $("#age-input").val().trim();
      quote = $("#quote-input").val().trim();

      $("#age-input").val('')
      $("#quote-input").val('')

      dataRef.ref().push({ //code for the push
        age: age,
        quote: quote,
        dateAdded: firebase.database.ServerValue.TIMESTAMP
      });
      
    });

     //Firebase watcher + initial loader HINT: This code behaves similarly to .on("value")
     dataRef.ref().on("child_added", function (childSnapshot) { 



    console.log("NAME:", childSnapshot.val().name); //Log everything that's coming out of snapshot
    console.log("AGE:", childSnapshot.val().age);

    //full list of items to the well
    $("#full-member-list").prepend("<div class='well'>" +
    " </span><span class ='member-quote'> " + childSnapshot.val().quote +
    " </span></div>");

    //handle the errors
    }, function (errorObject) {
       console.log("Errors handled: " + errorObject.code)

});

dataRef.ref().orderByChild("dateAdded").limitToLast(1).on("child_added", function (snapshot) {
$("#age-display").text(snapshot.val().age);
$("#quote-display").text(snapshot.val().quote);

});

    </script>
  

</body>
</html>